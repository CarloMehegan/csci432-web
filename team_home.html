<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="team_home.css">
</head>
<body>
    <a href="homepage.html" class="home-button">Home</a> <!-- home button -->
        
    <div class="web-container">
        <div class="side-bar">
            <div class="text-2">Motion Queue</div>
            <div id="motion-queue"></div>
            <button id="draft-motion-button" class="queue-item">Draft Motion</button> <!-- Draft Motion button -->
        </div>
        <div class="main-body">
            <div class="top-bar">
                <div id="text-1"></div>
                <div class="icons">
                    <div class="text-2">Members: </div>
                    <img src="home-imgs/avatar.png" alt="">
                    <img src="home-imgs/avatar.png" alt="">
                    <img src="home-imgs/avatar.png" alt="">
                </div>
            </div>
            <div class="motion">
                <div class="text-4"><strong>Current Motion</strong> </div>
                <div id="text-3"></div>
                <div id="text-desc"></div>
                <div class="motion-bottom">
                    <div class="voting-info">
                        <div class="text-5">4</div>
                        <img src="team-imgs/check.png" alt="">
                        <div class="text-5">2</div>
                        <img src="team-imgs/ex.png" alt="">
                    </div>
                    <div class="text-4">Raise Sub-Motion</div>
                    <div class="text-4">Close Motion</div>
                </div>
            </div>
            <div class="page-middle">
                <a href="\motion_archive"><div class="text-2">Motion Archive</div></a>
                <a href="\discussion" target="_blank"><div class="text-2">Discussion Page</div></a>
            </div>
        </div>

    </div>
</body>
</html>

<script>
    document.getElementById('draft-motion-button').addEventListener('click', () => {
            window.location.href = 'draft_motion.html';
        });
    fetch('http://localhost:3000/current')
    .then(response => response.json())
    .then(data => {
        const teamName = data.currentCommitteeName;
        return fetch(`http://localhost:3000/team/${teamName}`);
    })
    .then(response => response.json())
    .then(team => {
        const title = document.getElementById('text-1');
        const motion = document.getElementById('text-3');
        
        const titlediv = document.createElement('div');
        titlediv.textContent = team.name;
        title.appendChild(titlediv);

        const motiondiv = document.createElement('div');
        motiondiv.textContent = team.currentmotionName;
        motion.appendChild(motiondiv);
        console.log(team.currentMotion);

        return fetch(`http://localhost:3000/motion/${team.currentmotionName}`);
    })
    .then(response => response.json())
    .then(motion => {
        const desc = document.getElementById('text-desc');
        const descdiv = document.createElement('div');
        descdiv.textContent = motion.description;
        desc.appendChild(descdiv);
    })
    .catch((error) => {
        console.error('Error:', error);
    });

    fetch('http://localhost:3000/current')
        .then(response => response.json())
        .then(data => {
            const committeeName = data.currentCommitteeName;
            return fetch(`http://localhost:3000/motions/${encodeURIComponent(committeeName)}`);
        })
        .then(response => response.json())
        .then(motions => {
            const motionQueue = document.getElementById('motion-queue');
            motions.forEach(motion => {
                const motionDiv = document.createElement('div');
                motionDiv.classList.add('queue-item');
                motionDiv.textContent = motion.name;
                motionQueue.appendChild(motionDiv);
            });
        })
        .catch(error => console.error('Error:', error));
</script>