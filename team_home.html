<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="team_home.css">
</head>
<body>
    <div class="web-container">
        <a href="homepage.html" class="home-button">Home</a> <!-- home button -->
        <div class="side-bar">
            <div class="text-2">Motion Queue</div>
            <div class="queue-item">
            </div>
            <div class="queue-item">
            </div>
            <div class="queue-item">
            </div>
        </div>
        <div class="main-body">
            <div class="top-bar">
                <div id="text-1"></div>
                <div class="icons">
                    <div class="text-2">Members: </div>
                    <img src="home-imgs/avatar.png" alt="">
                    <img src="home-imgs/avatar.png" alt="">
                    <img src="home-imgs/avatar.png" alt="">
                </div>
            </div>
            <div class="motion">
                <div class="text-4">Current Motion</div>
                <div id="text-3"></div>
                <div id="text-desc"></div>
                <div class="motion-bottom">
                    <div class="voting-info">
                        <div class="text-5">4</div>
                        <img src="team-imgs/check.png" alt="">
                        <div class="text-5">2</div>
                        <img src="team-imgs/ex.png" alt="">
                    </div>
                    <div class="text-4">Raise Sub-Motion</div>
                    <div class="text-4">Close Motion</div>
                </div>
            </div>
            <div class="page-middle">
                <a href="\motion_archive"><div class="text-2">Motion Archive</div></a>
                <a href="\discussion" target="_blank"><div class="text-2">Discussion Page</div></a>
            </div>
        </div>

    </div>
</body>
</html>

<script>
    fetch('http://localhost:3000/current')
    .then(response => response.json())
    .then(data => {
        const teamName = data.currentCommitteeName;
        return fetch(`http://localhost:3000/team/${teamName}`);
    })
    .then(response => response.json())
    .then(team => {
        const title = document.getElementById('text-1');
        const motion = document.getElementById('text-3');
        
        const titlediv = document.createElement('div');
        titlediv.textContent = team.name;
        title.appendChild(titlediv);

        const motiondiv = document.createElement('div');
        motiondiv.textContent = team.currentmotionName;
        motion.appendChild(motiondiv);
        console.log(team.currentMotion);

        return fetch(`http://localhost:3000/motion/${team.currentmotionName}`);
    })
    .then(response => response.json())
    .then(motion => {
        const desc = document.getElementById('text-desc');
        const descdiv = document.createElement('div');
        descdiv.textContent = motion.description;
        desc.appendChild(descdiv);
    })
    .catch((error) => {
        console.error('Error:', error);
    });
</script>